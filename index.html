<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Franklin Santos">

<title>Diseños Experimentales</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Diseños Experimentales</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://franklinsantosm.com">Franklin Santos</a> <a href="https://orcid.org/0000-0002-7509-2910" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Universidad Austral de Chile
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<section id="introducción-al-diseño-de-experimentos" class="level2">
<h2 class="anchored" data-anchor-id="introducción-al-diseño-de-experimentos">Introducción al diseño de experimentos</h2>
<section id="potencia-cálculos-a-priori" class="level3">
<h3 class="anchored" data-anchor-id="potencia-cálculos-a-priori">POTENCIA CÁLCULOS A PRIORI</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d=</span>.<span class="dv">8</span>, <span class="at">sig.level=</span>.<span class="dv">05</span>, <span class="at">power=</span>.<span class="dv">9</span>, <span class="at">type=</span><span class="st">"two.sample"</span>,<span class="at">alternative=</span><span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 33.82555
              d = 0.8
      sig.level = 0.05
          power = 0.9
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Queremos comparar 5 grupos, con 25 sujetos por grupo, para un nivel de significación del 5%. Calculamos la potencia de la prueba para distintos valores de tamaño de efecto (f2):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">5</span>,<span class="at">n=</span><span class="dv">25</span>,<span class="at">f=</span><span class="fl">0.10</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>) <span class="co">#power = 0.1180955</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 5
              n = 25
              f = 0.1
      sig.level = 0.05
          power = 0.1180955

NOTE: n is number in each group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">5</span>,<span class="at">n=</span><span class="dv">25</span>,<span class="at">f=</span><span class="fl">0.25</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>) <span class="co">#power = 0.5738</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 5
              n = 25
              f = 0.25
      sig.level = 0.05
          power = 0.5738

NOTE: n is number in each group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">5</span>,<span class="at">n=</span><span class="dv">25</span>,<span class="at">f=</span><span class="fl">0.40</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>) <span class="co">#power = 0.9569163</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 5
              n = 25
              f = 0.4
      sig.level = 0.05
          power = 0.9569163

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>La potencia será de • 11.8% para detectar un efecto pequeño, • 57.4% para detectar un efecto moderado y • 95.7% para detectar un efecto grande.</p>
</section>
</section>
<section id="andeva-con-r-studio-para-diseño-experimental" class="level2">
<h2 class="anchored" data-anchor-id="andeva-con-r-studio-para-diseño-experimental">ANDEVA CON R-Studio para diseño experimental</h2>
<p>Paquetes:</p>
<ul>
<li><code>agricolae</code>: Procedimientos estadísticos básicos del diseño de experimentos, diseño de factor simple, bloques aleatorios, cuadrado latino, cuadrados grecolatinos, así como pruebas de diferencia de medias.</li>
<li><code>car</code>: técnicas para regresión aplicada</li>
<li><code>phia</code>: técnicas para graficar diseños experimentales</li>
<li><code>DoE.base</code>: apoyos para diseños factoriales</li>
<li><code>DoE.wrapper</code>: creación de diseños industriales e interactúa con otros paquetes para diseño de experimentos, diseños para estimar funciones cuadráticas tales como diseños compuestos centrales y diseños de Box-Behnken</li>
<li><code>FrF2</code>: Diseños factoriales a 2 niveles (2<sup>k</sup>) y factoriales fraccionados a 2 niveles (2<sup>k-p</sup>)</li>
<li><code>qualityTools</code>: Diseños factoriales a 2 niveles, factoriales fraccionados a 2 niveles, análisis de múltiples respuestas, diseños de superficie de respuesta, mezcla de diseños, Método Taguchi</li>
<li><code>rsm</code>: Metodología de superficie de respuesta</li>
</ul>
</section>
<section id="estadística-de-prueba-obtención-de-la-tabla-andeva-anova" class="level2">
<h2 class="anchored" data-anchor-id="estadística-de-prueba-obtención-de-la-tabla-andeva-anova">Estadística de prueba: Obtención de la Tabla Andeva (ANOVA)</h2>
<ol type="1">
<li>Importar los datos Leer los datos en R Studio. Digitando directamente (copiar y pegar).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nema<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">210</span>, <span class="dv">205</span>, <span class="dv">220</span>, <span class="dv">210</span>, <span class="dv">200</span>, <span class="dv">205</span>, <span class="dv">210</span>, <span class="dv">195</span>, <span class="dv">215</span>, <span class="dv">92</span>, <span class="dv">96</span>, <span class="dv">82</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dv">106</span>, <span class="dv">114</span>, <span class="dv">35</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">43</span>, <span class="dv">68</span>, <span class="dv">65</span>, <span class="dv">72</span>, <span class="dv">58</span>, <span class="dv">74</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>cultivar<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Huia"</span>,<span class="st">"Kopu"</span>,<span class="st">"Aran"</span>,<span class="st">"Pitau"</span>,<span class="st">"Will"</span>), <span class="at">each=</span><span class="dv">5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Explorar datos de la muestra Estadística Descriptiva</li>
</ol>
<p>Gráfico de caja y bigote</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(nema <span class="sc">~</span> cultivar, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"yellow"</span>, <span class="st">"blue"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">"white"</span>,<span class="st">"green"</span>,<span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"Número de</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">Nemátodo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Medias de los tratamientos (niveles)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(nema, cultivar, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Aran  Huia  Kopu Pitau  Will 
 98.0 203.0 205.0  33.6  67.4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(nema, cultivar, sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Aran      Huia      Kopu     Pitau      Will 
12.409674 19.235384  7.905694  5.856620  6.308724 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(nema, cultivar, range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Aran
[1]  82 114

$Huia
[1] 170 220

$Kopu
[1] 195 215

$Pitau
[1] 28 43

$Will
[1] 58 74</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Obtención de tabla ANOVA Esta es la forma de pedir un ANOVA en R:</li>
</ol>
<p>Códigos necesarios (cargar paquete agricolae)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"agricolae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculo Andeva del ejercicio de los nematodos según cultivar</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>an_e1<span class="ot">&lt;-</span><span class="fu">aov</span>(<span class="fu">lm</span>(nema<span class="sc">~</span>cultivar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Salida computacional</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(an_e1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
cultivar     4 124100   31025   234.8 &lt;2e-16 ***
Residuals   20   2642     132                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="practica" class="level2">
<h2 class="anchored" data-anchor-id="practica">Practica</h2>
<section id="importación-de-base-de-datos-1_datos-ejer-cap1.xlsx" class="level3">
<h3 class="anchored" data-anchor-id="importación-de-base-de-datos-1_datos-ejer-cap1.xlsx">Importación de base de datos <code>1_Datos ejer Cap1.xlsx</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>datadca <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje1"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>datadca</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 2
   Cultivar   Nem
   &lt;chr&gt;    &lt;dbl&gt;
 1 Huia       170
 2 Huia       210
 3 Huia       205
 4 Huia       220
 5 Huia       210
 6 Kopu       200
 7 Kopu       205
 8 Kopu       210
 9 Kopu       195
10 Kopu       215
# ℹ 15 more rows</code></pre>
</div>
</div>
</section>
<section id="analisis-descriptivo" class="level3">
<h3 class="anchored" data-anchor-id="analisis-descriptivo">Analisis descriptivo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metan)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">desc_stat</span>(datadca,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean, se, kurt, skew, min, max"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round_cols</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  variable  mean    se  kurt  skew   min   max
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Nem       121.  14.5 -1.73   0.2    28   220</code></pre>
</div>
</div>
<p>Box plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> datadca,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Cultivar,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>Nem,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span>Cultivar)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Variedades"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Número de nemátodos"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="analisis-de-varianza" class="level3">
<h3 class="anchored" data-anchor-id="analisis-de-varianza">Analisis de varianza</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AgroR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'AgroR'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    desc</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(datadca, <span class="fu">DIC</span>(Cultivar, Nem, <span class="at">ylab =</span> <span class="st">"Nemátodos"</span>)) <span class="co"># tukey</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Normality of errors
-----------------------------------------------------------------
                         Method Statistic    p.value
 Shapiro-Wilk normality test(W) 0.9260439 0.07045336</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Homogeneity of Variances
-----------------------------------------------------------------
                              Method Statistic   p.value
 Bartlett test(Bartlett's K-squared)  7.686977 0.1037415</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level,hypothesis H0 is not rejected. Therefore, the variances can be considered homogeneous</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Independence from errors
-----------------------------------------------------------------
                 Method Statistic    p.value
 Durbin-Watson test(DW)  1.837572 0.09604055</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Additional Information
-----------------------------------------------------------------

CV (%) =  9.47
MStrat/MST =  1
Mean =  121.4
Median =  96
Possible outliers =  No discrepant point

-----------------------------------------------------------------
Analysis of Variance
-----------------------------------------------------------------
          Df   Sum Sq  Mean.Sq  F value        Pr(F)
Treatment  4 124099.6 31024.90 234.8236 1.674412e-16
Residuals 20   2642.4   132.12                      </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value, it is less than the 5% significance level.The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

-----------------------------------------------------------------
Multiple Comparison Test: Tukey HSD
-----------------------------------------------------------------
       resp groups
Kopu  205.0      a
Huia  203.0      a
Aran   98.0      b
Will   67.4      c
Pitau  33.6      d</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="practica-en-clases-segunda-clase" class="level2">
<h2 class="anchored" data-anchor-id="practica-en-clases-segunda-clase">Practica en clases (segunda clase)</h2>
<p>Cargar la libreria para analizar datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Importamos la base de datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>datadca <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje1"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datadca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Cultivar   Nem
  &lt;chr&gt;    &lt;dbl&gt;
1 Huia       170
2 Huia       210
3 Huia       205
4 Huia       220
5 Huia       210
6 Kopu       200</code></pre>
</div>
</div>
<p>Vemos que la variable cultivar esta en formato caracter, por tanto, se requiere la transformacion de datos como factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>datadca <span class="ot">=</span> datadca<span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'Cultivar'</span>), as.factor)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datadca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Cultivar   Nem
  &lt;fct&gt;    &lt;dbl&gt;
1 Huia       170
2 Huia       210
3 Huia       205
4 Huia       220
5 Huia       210
6 Kopu       200</code></pre>
</div>
</div>
<p>Una vez verificada que nuestras variables esten en formato fator y numerica se procede a realizar la respectiva analisis de varianza.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de varianza</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>av_nema <span class="ot">=</span> <span class="fu">aov</span>(Nem<span class="sc">~</span>Cultivar, <span class="at">data =</span> datadca)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(av_nema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
Cultivar     4 124100   31025   234.8 &lt;2e-16 ***
Residuals   20   2642     132                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>De acuerdo a la tabla de analisis de varianza rechazamos de la hipotesis nula y al menos existe diferencia significativa entre cultivares respecto al numero de nematodos.</p>
<p>Verificada la diferencia significativa, se procede a un analisis de medias para identificar el cultivar menos infestado con nematodos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de datos a posteriori</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="do">##prueba posteriori LSD</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>lsd_nem <span class="ot">=</span> <span class="fu">LSD.test</span>(av_nema, <span class="st">"Cultivar"</span>, <span class="at">group =</span> T, <span class="at">console =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: av_nema ~ "Cultivar"

LSD t Test for Nem 

Mean Square Error:  132.12 

Cultivar,  means and individual ( 95 %) CI

        Nem       std r       se       LCL       UCL Min Max Q25 Q50 Q75
Aran   98.0 12.409674 5 5.140428  87.27726 108.72274  82 114  92  96 106
Huia  203.0 19.235384 5 5.140428 192.27726 213.72274 170 220 205 210 210
Kopu  205.0  7.905694 5 5.140428 194.27726 215.72274 195 215 200 205 210
Pitau  33.6  5.856620 5 5.140428  22.87726  44.32274  28  43  30  32  35
Will   67.4  6.308724 5 5.140428  56.67726  78.12274  58  74  65  68  72

Alpha: 0.05 ; DF Error: 20
Critical Value of t: 2.085963 

least Significant Difference: 15.16425 

Treatments with the same letter are not significantly different.

        Nem groups
Kopu  205.0      a
Huia  203.0      a
Aran   98.0      b
Will   67.4      c
Pitau  33.6      d</code></pre>
</div>
</div>
<p>De acuerdo a los resultados de diferencia minima significativa se puede identificar que el cultivar <code>Pitau</code> tuvo una infestacion minima de nematodos.</p>
<p>Asimismo, se procede a analizar con la prueba de <code>TUKEY</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">##prueba posteriori TUKEY</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>dhs_nem <span class="ot">=</span> <span class="fu">HSD.test</span>(av_nema, <span class="st">"Cultivar"</span>, <span class="at">alpha =</span> <span class="fl">0.01</span>, <span class="at">group =</span> T)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dhs_nem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df  Mean      CV      MSD
   132.12 20 121.4 9.46816 27.20958

$parameters
   test   name.t ntr StudentizedRange alpha
  Tukey Cultivar   5         5.293253  0.01

$means
        Nem       std r       se Min Max Q25 Q50 Q75
Aran   98.0 12.409674 5 5.140428  82 114  92  96 106
Huia  203.0 19.235384 5 5.140428 170 220 205 210 210
Kopu  205.0  7.905694 5 5.140428 195 215 200 205 210
Pitau  33.6  5.856620 5 5.140428  28  43  30  32  35
Will   67.4  6.308724 5 5.140428  58  74  65  68  72

$comparison
NULL

$groups
        Nem groups
Kopu  205.0      a
Huia  203.0      a
Aran   98.0      b
Will   67.4      c
Pitau  33.6      d

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dhs_nem2 <span class="ot">=</span> <span class="fu">TukeyHSD</span>(av_nema, <span class="at">conf.level =</span> .<span class="dv">99</span>, <span class="at">console =</span> T, <span class="at">ordered =</span> T)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>dhs_nem2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    99% family-wise confidence level
    factor levels have been ordered

Fit: aov(formula = Nem ~ Cultivar, data = datadca)

$Cultivar
            diff        lwr       upr     p adj
Will-Pitau  33.8   6.590417  61.00958 0.0013004
Aran-Pitau  64.4  37.190417  91.60958 0.0000002
Huia-Pitau 169.4 142.190417 196.60958 0.0000000
Kopu-Pitau 171.4 144.190417 198.60958 0.0000000
Aran-Will   30.6   3.390417  57.80958 0.0035183
Huia-Will  135.6 108.390417 162.80958 0.0000000
Kopu-Will  137.6 110.390417 164.80958 0.0000000
Huia-Aran  105.0  77.790417 132.20958 0.0000000
Kopu-Aran  107.0  79.790417 134.20958 0.0000000
Kopu-Huia    2.0 -25.209583  29.20958 0.9986312</code></pre>
</div>
</div>
<p>La prueba de Tukey corrobora lo antes mencionado.</p>
<section id="ejercicios-de-practica" class="level3">
<h3 class="anchored" data-anchor-id="ejercicios-de-practica">Ejercicios de practica</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Segunda practica</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>dataEJ3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje3"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Dieta   C_suero
  &lt;chr&gt;   &lt;chr&gt;  
1 Premuda 97.9   
2 Premuda 90.5   
3 Premuda 99.4   
4 Premuda 73.6   
5 Premuda 74.4   
6 Ayuno   98.8   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>dataEJ3 <span class="ot">=</span> dataEJ3<span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'Dieta'</span>), as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'C_suero'</span>), as.numeric)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Dieta   C_suero
  &lt;fct&gt;     &lt;dbl&gt;
1 Premuda    97.9
2 Premuda    90.5
3 Premuda    99.4
4 Premuda    73.6
5 Premuda    74.4
6 Ayuno      98.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de varianza</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>av_dieta <span class="ot">=</span> <span class="fu">aov</span>(C_suero<span class="sc">~</span>Dieta, <span class="at">data =</span> dataEJ3)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(av_dieta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Dieta        4  48307   12077   75.92 8.42e-12 ***
Residuals   20   3181     159                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de datos a posteriori</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="do">##prueba posteriori TUKEY</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>dieta <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(av_dieta, <span class="st">"Dieta"</span>, <span class="at">alpha=</span><span class="fl">0.01</span>, <span class="at">group=</span><span class="cn">TRUE</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dieta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror Df    Mean       CV      MSD
  159.0644 20 120.968 10.42596 29.85548

$parameters
   test name.t ntr StudentizedRange alpha
  Tukey  Dieta   5         5.293253  0.01

$means
          C_suero       std r       se   Min   Max   Q25   Q50   Q75
60salvado  206.16 19.837792 5 5.640291 177.5 226.1 197.2 207.3 222.7
80salvado  110.70  8.453402 5 5.640291 101.1 119.9 102.9 112.1 117.5
Ayuno      112.86 11.990746 5 5.640291  98.8 129.1 103.6 115.2 117.6
Mmalta      87.96  5.549144 5 5.640291  82.9  96.4  83.1  87.8  89.6
Premuda     87.16 12.480104 5 5.640291  73.6  99.4  74.4  90.5  97.9

$comparison
NULL

$groups
          C_suero groups
60salvado  206.16      a
Ayuno      112.86      b
80salvado  110.70      b
Mmalta      87.96      b
Premuda     87.16      b

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Ejercicio 4</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>dataEJ4 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje4"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Sector   salario
  &lt;chr&gt;      &lt;dbl&gt;
1 Valencia     299
2 Valencia     313
3 Valencia     300
4 Valencia     321
5 Valencia     308
6 Valencia     312</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dataEJ4 <span class="ot">=</span> dataEJ4<span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'Sector'</span>), as.factor)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Sector   salario
  &lt;fct&gt;      &lt;dbl&gt;
1 Valencia     299
2 Valencia     313
3 Valencia     300
4 Valencia     321
5 Valencia     308
6 Valencia     312</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de varianza</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>av_sector <span class="ot">=</span> <span class="fu">aov</span>(salario<span class="sc">~</span>Sector, <span class="at">data =</span> dataEJ4)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(av_sector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Sector        2  86713   43356     558 &lt;2e-16 ***
Residuals   147  11422      78                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de datos a posteriori</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="do">##prueba posteriori TUKEY</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>dhs_sector <span class="ot">=</span> <span class="fu">HSD.test</span>(av_sector, <span class="st">"Sector"</span>, <span class="at">alpha=</span><span class="fl">0.01</span>, <span class="at">group=</span>T)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dhs_sector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror  Df     Mean       CV      MSD
  77.70082 147 274.0467 3.216535 5.217182

$parameters
   test name.t ntr StudentizedRange alpha
  Tukey Sector   3         4.185123  0.01

$means
          salario      std  r       se Min Max Q25   Q50    Q75
Alicante   279.10 8.593424 50 1.246602 265 304 272 280.0 284.75
Castellón  242.40 8.228869 50 1.246602 229 261 236 242.5 248.00
Valencia   300.64 9.567718 50 1.246602 276 321 295 300.0 308.00

$comparison
NULL

$groups
          salario groups
Valencia   300.64      a
Alicante   279.10      b
Castellón  242.40      c

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Ejercicio 2</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>dataEJ2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje2"</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Tipo_cereal C_tianina
  &lt;chr&gt;       &lt;chr&gt;    
1 Trigo       5.2      
2 Trigo       4.5      
3 Trigo       6        
4 Trigo       6.1      
5 Trigo       6.7      
6 Trigo       5.8      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>dataEJ2 <span class="ot">=</span> dataEJ2<span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'Tipo_cereal'</span>), as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'C_tianina'</span>), as.numeric)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Tipo_cereal C_tianina
  &lt;fct&gt;           &lt;dbl&gt;
1 Trigo             5.2
2 Trigo             4.5
3 Trigo             6  
4 Trigo             6.1
5 Trigo             6.7
6 Trigo             5.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de varianza</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>av_cereal <span class="ot">=</span> <span class="fu">aov</span>(C_tianina<span class="sc">~</span>Tipo_cereal, <span class="at">data =</span> dataEJ2)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(av_cereal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
Tipo_cereal  3  42.89  14.297    3.08 0.0509 .
Residuals   20  92.83   4.641                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de datos a posteriori</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="do">##prueba posteriori TUKEY</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>dhs_cereal <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(av_cereal, <span class="st">"Tipo_cereal"</span>, <span class="at">alpha=</span><span class="fl">0.10</span>, <span class="at">group=</span>T)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dhs_cereal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df Mean       CV      MSD
   4.6415 20  6.9 31.22339 3.044551

$parameters
   test      name.t ntr StudentizedRange alpha
  Tukey Tipo_cereal   4         3.461543   0.1

$means
       C_tianina       std r        se Min  Max   Q25  Q50    Q75
Avena   7.716667 3.9448278 6 0.8795359 3.0 12.5 4.750 7.40 10.950
cebada  8.666667 1.4023789 6 0.8795359 6.5 10.0 8.000 8.75  9.875
Maíz    5.500000 0.6693280 6 0.8795359 4.7  6.4 4.975 5.50  5.950
Trigo   5.716667 0.7678976 6 0.8795359 4.5  6.7 5.350 5.90  6.075

$comparison
NULL

$groups
       C_tianina groups
cebada  8.666667      a
Avena   7.716667     ab
Trigo   5.716667     ab
Maíz    5.500000      b

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Ejecicio de colores 5</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>dataEJ5 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje5"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  color insectos
  &lt;chr&gt;    &lt;dbl&gt;
1 Azul        16
2 Azul        11
3 Azul        20
4 Azul        21
5 Azul        14
6 Azul         7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>dataEJ5 <span class="ot">&lt;-</span> dataEJ5<span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'color'</span>), as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'insectos'</span>), as.numeric)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataEJ5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  color insectos
  &lt;fct&gt;    &lt;dbl&gt;
1 Azul        16
2 Azul        11
3 Azul        20
4 Azul        21
5 Azul        14
6 Azul         7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">=</span> <span class="fu">as.factor</span>(dataEJ5<span class="sc">$</span>color) <span class="co"># funciona para correr levene</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>insectos <span class="ot">=</span> <span class="fu">as.numeric</span>(dataEJ5<span class="sc">$</span>insectos) <span class="co"># funciona para correr levene</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de varianza</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>av_color <span class="ot">=</span> <span class="fu">aov</span>(insectos<span class="sc">~</span>color, <span class="at">data =</span> dataEJ5)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(av_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
color        3   4218    1406   30.55 1.15e-07 ***
Residuals   20    921      46                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de datos a posteriori</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="do">##prueba posteriori TUKEY</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>dhs_color <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(av_color, <span class="st">"color"</span>, <span class="at">alpha=</span><span class="fl">0.01</span>, <span class="at">group=</span>T)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dhs_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean       CV      MSD
   46.025 20 27.29167 24.85804 13.89803

$parameters
   test name.t ntr StudentizedRange alpha
  Tukey  color   4         5.018016  0.01

$means
         insectos      std r       se Min Max   Q25  Q50   Q75
Amarillo 47.16667 6.794606 6 2.769627  38  59 45.25 46.5 47.75
Azul     14.83333 5.344779 6 2.769627   7  21 11.75 15.0 19.00
Blanco   15.66667 3.326660 6 2.769627  12  21 13.25 15.5 17.00
Verde    31.50000 9.914636 6 2.769627  15  41 26.75 34.5 38.50

$comparison
NULL

$groups
         insectos groups
Amarillo 47.16667      a
Verde    31.50000      b
Blanco   15.66667      c
Azul     14.83333      c

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homogeneidad de varianzas</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(insectos, <span class="at">group=</span>color, <span class="at">center =</span> <span class="st">"median"</span>, <span class="at">data =</span> dataEJ5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median": dataEJ5)
      Df F value Pr(&gt;F)
group  3  1.2875 0.3059
      20               </code></pre>
</div>
</div>
</section>
</section>
<section id="clase-3" class="level2">
<h2 class="anchored" data-anchor-id="clase-3">Clase 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>datadca <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"1_Datos ejer Cap1.xlsx"</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"Eje1"</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datadca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Cultivar   Nem
  &lt;chr&gt;    &lt;dbl&gt;
1 Huia       170
2 Huia       210
3 Huia       205
4 Huia       220
5 Huia       210
6 Kopu       200</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>datadca <span class="ot">=</span> datadca<span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'Cultivar'</span>), as.factor)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datadca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Cultivar   Nem
  &lt;fct&gt;    &lt;dbl&gt;
1 Huia       170
2 Huia       210
3 Huia       205
4 Huia       220
5 Huia       210
6 Kopu       200</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">### analisis de varianza</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>av_nema <span class="ot">=</span> <span class="fu">aov</span>(Nem<span class="sc">~</span>Cultivar, <span class="at">data =</span> datadca)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(av_nema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
Cultivar     4 124100   31025   234.8 &lt;2e-16 ***
Residuals   20   2642     132                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>Cultivar <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datadca<span class="sc">$</span>Cultivar)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>Nem <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(datadca<span class="sc">$</span>Nem)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># normalidad</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(av_nema))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(av_nema)
W = 0.92604, p-value = 0.07045</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Análisis gráfico</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(av_nema<span class="sc">$</span>residuals) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homogeneidad de varianza</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 1. Levene test</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Nem, <span class="at">group=</span>Cultivar, <span class="at">center =</span> <span class="st">"median"</span>, <span class="at">data =</span> datadca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median": datadca)
      Df F value Pr(&gt;F)
group  4  0.5987 0.6678
      20               </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homogeneidad de varianza</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Bartlett test</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(av_nema<span class="sc">$</span>residuals <span class="sc">~</span> Cultivar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  av_nema$residuals by Cultivar
Bartlett's K-squared = 7.687, df = 4, p-value = 0.1037</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Independencia</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(av_nema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      -0.1330911      1.837572   0.206
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ejercicio 1</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla andeva</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.95</span>, <span class="dv">2</span>, <span class="dv">71</span>) <span class="co">#(2=glados de libertad de tratamiento)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.125764</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.99</span>, <span class="dv">2</span>, <span class="dv">71</span>) <span class="co">#(71=grados de libertad del error experimental)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.917215</code></pre>
</div>
</div>
</section>
<section id="ejercicio-2-de-la-practica" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-2-de-la-practica">Ejercicio 2 de la practica</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dbe1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Ej2.xlsx"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dbe1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Medio_cultivo Brotes
  &lt;chr&gt;          &lt;dbl&gt;
1 Testigo            3
2 Testigo            1
3 Testigo            3
4 Testigo            3
5 Testigo            7
6 Testigo            6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dbe1, <span class="fu">DIC</span>(Medio_cultivo, Brotes, <span class="at">ylab =</span> <span class="st">"Numero de brotes"</span>)) <span class="co"># tukey</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Normality of errors
-----------------------------------------------------------------
                         Method Statistic    p.value
 Shapiro-Wilk normality test(W) 0.9470772 0.03062369</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is less than the 5% significance level, H0 is rejected. Therefore, errors do not follow a normal distribution</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Homogeneity of Variances
-----------------------------------------------------------------
                              Method Statistic    p.value
 Bartlett test(Bartlett's K-squared)  15.50982 0.00142896</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is less than the 5% significance level, H0 is rejected.Therefore, the variances are not homogeneous</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Independence from errors
-----------------------------------------------------------------
                 Method Statistic   p.value
 Durbin-Watson test(DW)  1.819563 0.1402301</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Additional Information
-----------------------------------------------------------------

CV (%) =  61.77
MStrat/MST =  0.61
Mean =  5.6458
Median =  5
Possible outliers =  No discrepant point

-----------------------------------------------------------------
Analysis of Variance
-----------------------------------------------------------------
          Df    Sum Sq  Mean.Sq  F value     Pr(F)
Treatment  3  57.89583 19.29861 1.586928 0.2060557
Residuals 44 535.08333 12.16098                   </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, H0 is not rejected</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

-----------------------------------------------------------------
Multiple Comparison Test: Tukey HSD
-----------------------------------------------------------------
[1] "H0 is not rejected"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Your analysis is not valid, suggests using a non-parametric test and try to transform the data</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Analisis de varianza</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>aov_br <span class="ot">=</span> <span class="fu">aov</span>(Brotes<span class="sc">~</span>Medio_cultivo,  <span class="at">data =</span> dbe1)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_br)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)
Medio_cultivo  3   57.9   19.30   1.587  0.206
Residuals     44  535.1   12.16               </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aov_br)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalidad</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(aov_br))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(aov_br)
W = 0.94708, p-value = 0.03062</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformacion de datos a factor y numerico</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>Medio_cultivo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dbe1<span class="sc">$</span>Medio_cultivo)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>Brotes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dbe1<span class="sc">$</span>Brotes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homogeneidad de varianza</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 1. Levene test</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Brotes, <span class="at">group=</span>Medio_cultivo, <span class="at">center =</span> <span class="st">"median"</span>, <span class="at">data =</span> dbe11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median": dbe11)
      Df F value  Pr(&gt;F)  
group  3  3.8307 0.01601 *
      44                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Debido a que no se cumple los supuestos de normalidad, homogeneidad e independencia, se procede a transformar los datos con logaritmo para buscar si existe alguna diferencia entre tratamientos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformacion de datos con logarito (log)</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>aov_br <span class="ot">=</span> <span class="fu">aov</span>(<span class="fu">log</span>(Brotes)<span class="sc">~</span>Medio_cultivo,  <span class="at">data =</span> dbe1)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_br)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)
Medio_cultivo  3  0.822  0.2740   0.579  0.632
Residuals     44 20.831  0.4734               </code></pre>
</div>
</div>
<p>El resultado es no significativo, aunque se realizo un analisis de varianza con transformacion de datos. Por tanto, no hay diferencias en ningun caso y tampoco cumple los supuestos de normalidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(<span class="fu">log</span>(Brotes), <span class="at">group=</span>Medio_cultivo, <span class="at">center =</span> <span class="st">"median"</span>, <span class="at">data =</span> dbe11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median": dbe11)
      Df F value Pr(&gt;F)
group  3  1.1459 0.3412
      44               </code></pre>
</div>
</div>
<p>Sin embargo, realizando una transformacion de datos se pudo cumplir el supuesto de homegeneidad de varianza. Pero, no hay diferencias significativas entre tratamiento de acuerdo al analisis de varianza</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#=============================</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Kruskal-Wallis</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co">#=============================</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dbe1, <span class="fu">DIC</span>(Medio_cultivo, Brotes, <span class="at">test =</span> <span class="st">"noparametric"</span>, <span class="at">ylab =</span> <span class="st">"Numero de brotes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

-----------------------------------------------------------------
Statistics
-----------------------------------------------------------------
     Chisq   p.chisq
  2.454764 0.4835218


-----------------------------------------------------------------
Parameters
-----------------------------------------------------------------
            test p.ajusted name.t ntr alpha
  Kruskal-Wallis      holm   trat   4  0.05


-----------------------------------------------------------------
Multiple Comparison Test: LSD
-----------------------------------------------------------------
            Mean       SD     Rank Groups
AIB_05  6.916667 4.756973 27.87500      a
BAP_05  4.916667 2.151462 23.66667      a
BAP_1   6.500000 4.337993 26.70833      a
Testigo 4.250000 1.602555 19.75000      a</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>